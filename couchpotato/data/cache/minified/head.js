// /opt/couchpotato/couchpotato/core/_base/downloader/static/downloaders.js:1432482254
var DownloadersBase=new Class({Implements:[Events],initialize:function(){var self=this;App.addEvent('loadSettings',self.addTestButtons.bind(self));},addTestButtons:function(){var self=this;var setting_page=App.getPage('Settings');setting_page.addEvent('create',function(){Object.each(setting_page.tabs.downloaders.groups,self.addTestButton.bind(self))})},addTestButton:function(fieldset,plugin_name){var self=this,button_name=self.testButtonName(fieldset);if(button_name.contains('Downloaders'))return;new Element('.ctrlHolder.test_button').adopt(new Element('a.button',{'text':button_name,'events':{'click':function(){var button=fieldset.getElement('.test_button .button');button.set('text','Connecting...');Api.request('download.'+plugin_name+'.test',{'onComplete':function(json){button.set('text',button_name);var message;if(json.success){message=new Element('span.success',{'text':'Connection successful'}).inject(button,'after')}
else{var msg_text='Connection failed. Check logs for details.';if(json.hasOwnProperty('msg'))msg_text=json.msg;message=new Element('span.failed',{'text':msg_text}).inject(button,'after')}
(function(){message.destroy();}).delay(3000)}});}}})).inject(fieldset);},testButtonName:function(fieldset){var name=String(fieldset.getElement('h2').innerHTML).substring(0,String(fieldset.getElement('h2').innerHTML).indexOf("<span"));return'Test '+name;}});var Downloaders=new DownloadersBase();

// /opt/couchpotato/couchpotato/core/_base/updater/static/updater.js:1432482254
var UpdaterBase=new Class({Implements:[Events],initialize:function(){var self=this;App.addEvent('load',self.info.bind(self,2000));App.addEvent('unload',function(){if(self.timer)
clearTimeout(self.timer);});},check:function(onComplete){var self=this;Api.request('updater.check',{'onComplete':function(json){if(onComplete)
onComplete(json);if(json.update_available)
self.doUpdate();else{App.unBlockPage();App.trigger('message',['No updates available']);}}})},info:function(timeout){var self=this;if(self.timer)clearTimeout(self.timer);self.timer=setTimeout(function(){Api.request('updater.info',{'onComplete':function(json){self.json=json;self.fireEvent('loaded',[json]);if(json.update_version){self.createMessage(json);}
else{if(self.message)
self.message.destroy();}}})},(timeout||0))},getInfo:function(){return this.json;},createMessage:function(data){var self=this;if(self.message)return;var changelog='https://github.com/'+data.repo_name+'/compare/'+data.version.hash+'...'+data.branch;if(data.update_version.changelog)
changelog=data.update_version.changelog+'#'+data.version.hash+'...'+data.update_version.hash;self.message=new Element('div.message.update').adopt(new Element('span',{'text':'A new version is available'}),new Element('a',{'href':changelog,'text':'see what has changed','target':'_blank'}),new Element('span[text=or]'),new Element('a',{'text':'just update, gogogo!','events':{'click':self.doUpdate.bind(self)}})).inject(document.body)},doUpdate:function(){var self=this;App.blockPage('Please wait while CouchPotato is being updated with more awesome stuff.','Updating');Api.request('updater.update',{'onComplete':function(json){if(json.success)
self.updating();else
App.unBlockPage()}});},updating:function(){App.checkAvailable.delay(500,App,[1000,function(){window.location.reload();}]);if(self.message)
self.message.destroy();}});var Updater=new UpdaterBase();

// /opt/couchpotato/couchpotato/core/plugins/category/static/category.js:1432482254
var CategoryListBase=new Class({initialize:function(){var self=this;App.addEvent('loadSettings',self.addSettings.bind(self));},setup:function(categories){var self=this;self.categories=[];Array.each(categories,self.createCategory.bind(self));},addSettings:function(){var self=this;self.settings=App.getPage('Settings');self.settings.addEvent('create',function(){var tab=self.settings.createSubTab('category',{'label':'Categories','name':'category','subtab_label':'Category & filtering'},self.settings.tabs.searcher,'searcher');self.tab=tab.tab;self.content=tab.content;self.createList();self.createOrdering();});self.settings.addEvent('create',function(){var renamer_group=self.settings.tabs.renamer.groups.renamer;self.categories.each(function(category){var input=new Option.Directory('section_name','option.name',category.get('destination'),{'name':category.get('label')});input.inject(renamer_group.getElement('.renamer_to'));input.fireEvent('injected');input.save=function(){category.data.destination=input.getValue();category.save();};});})},createList:function(){var self=this;var count=self.categories.length;self.settings.createGroup({'label':'Categories','description':'Create categories, each one extending global filters. (Needs refresh \''+(App.isMac()?'CMD+R':'F5')+'\' after editing)'}).inject(self.content).adopt(self.category_container=new Element('div.container'),new Element('a.add_new_category',{'text':count>0?'Create another category':'Click here to create a category.','events':{'click':function(){var category=self.createCategory();$(category).inject(self.category_container)}}}));Array.each(self.categories,function(category){$(category).inject(self.category_container)});},getCategory:function(id){return this.categories.filter(function(category){return category.data._id==id}).pick()},getAll:function(){return this.categories;},createCategory:function(data){var self=this;var data=data||{'id':randomString()};var category=new Category(data);self.categories.include(category);return category;},createOrdering:function(){var self=this;var category_list;self.settings.createGroup({'label':'Category ordering'}).adopt(new Element('.ctrlHolder#category_ordering').adopt(new Element('label[text=Order]'),category_list=new Element('ul'),new Element('p.formHint',{'html':'Change the order the categories are in the dropdown list.<br />First one will be default.'}))).inject(self.content);Array.each(self.categories,function(category){new Element('li',{'data-id':category.data._id}).adopt(new Element('span.category_label',{'text':category.data.label}),new Element('span.handle')).inject(category_list);});self.category_sortable=new Sortables(category_list,{'revert':true,'handle':'','opacity':0.5,'onComplete':self.saveOrdering.bind(self)});},saveOrdering:function(){var self=this;var ids=[];self.category_sortable.list.getElements('li').each(function(el){ids.include(el.get('data-id'));});Api.request('category.save_order',{'data':{'ids':ids}});}});window.CategoryList=new CategoryListBase();var Category=new Class({data:{},initialize:function(data){var self=this;self.data=data;self.create();self.el.addEvents({'change:relay(select)':self.save.bind(self,0),'keyup:relay(input[type=text])':self.save.bind(self,[300])});},create:function(){var self=this;var data=self.data;self.el=new Element('div.category').adopt(self.delete_button=new Element('span.delete.icon2',{'events':{'click':self.del.bind(self)}}),new Element('.category_label.ctrlHolder').adopt(new Element('label',{'text':'Name'}),new Element('input.inlay',{'type':'text','value':data.label,'placeholder':'Example: Kids, Horror or His'}),new Element('p.formHint',{'text':'See global filters for explanation.'})),new Element('.category_preferred.ctrlHolder').adopt(new Element('label',{'text':'Preferred'}),new Element('input.inlay',{'type':'text','value':data.preferred,'placeholder':'Blu-ray, DTS'})),new Element('.category_required.ctrlHolder').adopt(new Element('label',{'text':'Required'}),new Element('input.inlay',{'type':'text','value':data.required,'placeholder':'Example: DTS, AC3 & English'})),new Element('.category_ignored.ctrlHolder').adopt(new Element('label',{'text':'Ignored'}),new Element('input.inlay',{'type':'text','value':data.ignored,'placeholder':'Example: dubbed, swesub, french'})));self.makeSortable()},save:function(delay){var self=this;if(self.save_timer)clearTimeout(self.save_timer);self.save_timer=(function(){Api.request('category.save',{'data':self.getData(),'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(json){if(json.success){self.data=json.category;}}});}).delay(delay||0,self)},getData:function(){var self=this;return{'id':self.data._id,'label':self.el.getElement('.category_label input').get('value'),'required':self.el.getElement('.category_required input').get('value'),'preferred':self.el.getElement('.category_preferred input').get('value'),'ignored':self.el.getElement('.category_ignored input').get('value'),'destination':self.data.destination}},del:function(){var self=this;if(self.data.label==undefined){self.el.destroy();return;}
var label=self.el.getElement('.category_label input').get('value');var qObj=new Question('Are you sure you want to delete <strong>"'+label+'"</strong>?','',[{'text':'Delete "'+label+'"','class':'delete','events':{'click':function(e){(e).preventDefault();Api.request('category.delete',{'data':{'id':self.data._id},'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(json){if(json.success){qObj.close();self.el.destroy();}else{alert(json.message);}}});}}},{'text':'Cancel','cancel':true}]);},makeSortable:function(){var self=this;self.sortable=new Sortables(self.category_container,{'revert':true,'handle':'.handle','opacity':0.5,'onComplete':self.save.bind(self,300)});},get:function(attr){return this.data[attr]},toElement:function(){return this.el}});

// /opt/couchpotato/couchpotato/core/plugins/log/static/log.js:1432482254
Page.Log=new Class({Extends:PageBase,order:60,name:'log',title:'Show recent logs.',has_tab:false,log_items:[],report_text:'\
### Steps to reproduce:\n\
1. ..\n\
2. ..\n\
\n\
### Information:\n\
Movie(s) I have this with: ...\n\
Quality of the movie being searched: ...\n\
Providers I use: ...\n\
Version of CouchPotato: {version}\n\
Running on: ...\n\
\n\
### Logs:\n\
```\n{issue}```',indexAction:function(){var self=this;self.getLogs(0);},getLogs:function(nr){var self=this;if(self.log)self.log.destroy();self.log=new Element('div.container.loading',{'text':'loading...','events':{'mouseup:relay(.time)':function(e){self.showSelectionButton.delay(100,self,e);}}}).inject(self.el);Api.request('logging.get',{'data':{'nr':nr},'onComplete':function(json){self.log.set('text','');self.log_items=self.createLogElements(json.log);self.log.adopt(self.log_items);self.log.removeClass('loading');var nav=new Element('ul.nav',{'events':{'click:relay(li.select)':function(e,el){self.getLogs(parseInt(el.get('text'))-1);}}});new Element('li.filter').grab(new Element('select',{'events':{'change':function(){var type_filter=this.getSelected()[0].get('value');self.el.set('data-filter',type_filter);self.scrollToBottom();}}}).adopt(new Element('option',{'value':'ALL','text':'Show all logs'}),new Element('option',{'value':'INFO','text':'Show only INFO'}),new Element('option',{'value':'DEBUG','text':'Show only DEBUG'}),new Element('option',{'value':'ERROR','text':'Show only ERROR'}))).inject(nav);for(var i=0;i<=json.total;i++){new Element('li',{'text':i+1,'class':'select '+(nr==i?'active':'')}).inject(nav);}
new Element('li.clear',{'text':'clear','events':{'click':function(){Api.request('logging.clear',{'onComplete':function(){self.getLogs(0);}});}}}).inject(nav);new Element('li.hint',{'text':'Select multiple lines & report an issue'}).inject(nav);nav.inject(self.log,'top');self.scrollToBottom();}});},createLogElements:function(logs){var elements=[];logs.each(function(log){elements.include(new Element('div',{'class':'time '+log.type.toLowerCase()}).adopt(new Element('span',{'text':log.time}),new Element('span.type',{'text':log.type}),new Element('span.message',{'text':log.message})))});return elements;},scrollToBottom:function(){new Fx.Scroll(window,{'duration':0}).toBottom();},showSelectionButton:function(e){var self=this,selection=self.getSelected(),start_node=selection.anchorNode,parent_start=start_node.parentNode.getParent('.time'),end_node=selection.focusNode.parentNode.getParent('.time'),text='';var remove_button=function(){self.log.getElements('.highlight').removeClass('highlight');if(self.do_report)
self.do_report.destroy();document.body.removeEvent('click',remove_button);};remove_button();if(parent_start)
start_node=parent_start;var index={'start':self.log_items.indexOf(start_node),'end':self.log_items.indexOf(end_node)};if(index.start>index.end){index={'start':index.end,'end':index.start};}
var nodes=self.log_items.slice(index.start,index.end+1);nodes.each(function(node,nr){node.addClass('highlight');node.getElements('span').each(function(span){text+=self.spaceFill(span.get('text')+' ',6);});text+='\n';});self.do_report=new Element('a.do_report.button',{'text':'Report issue','styles':{'top':e.page.y,'left':e.page.x},'events':{'click':function(e){(e).stop();self.showReport(text);}}}).inject(document.body);setTimeout(function(){document.body.addEvent('click',remove_button);},0);},showReport:function(text){var self=this,version=Updater.getInfo(),body=self.report_text.replace('{issue}',text).replace('{version}',version?version.version.repr:'...'),textarea;var overlay=new Element('div.report',{'method':'post','events':{'click':function(e){overlay.destroy();}}}).grab(new Element('div.bug',{'events':{'click':function(e){(e).stopPropagation();}}}).adopt(new Element('h1',{'text':'Report a bug'}),new Element('span').adopt(new Element('span',{'text':'Read '}),new Element('a.button',{'target':'_blank','text':'the contributing guide','href':'https://github.com/RuudBurger/CouchPotatoServer/blob/develop/contributing.md'}),new Element('span',{'html':' before posting, then copy the text below and <strong>FILL IN</strong> the dots.'})),textarea=new Element('textarea',{'text':body,'events':{'click':function(){this.select();}}}),new Element('a.button',{'target':'_blank','text':'Create a new issue on GitHub with the text above','href':'https://github.com/RuudBurger/CouchPotatoServer/issues/new','events':{'click':function(e){(e).stop();var body=textarea.get('value'),bdy='?body='+(body.length<2000?encodeURIComponent(body):'Paste the text here'),win=window.open(e.target.get('href')+bdy,'_blank');win.focus();}}})));overlay.inject(self.log);},getSelected:function(){if(window.getSelection)
return window.getSelection();else if(document.getSelection)
return document.getSelection();else{var selection=document.selection&&document.selection.createRange();if(selection.text)
return selection.text;}
return false;},spaceFill:function(number,width){if(number.toString().length>=width)
return number;return(new Array(width).join(' ')+number.toString()).substr(-width);}});

// /opt/couchpotato/couchpotato/core/plugins/profile/static/profile.js:1432482254
var Profile=new Class({data:{},types:[],initialize:function(data){var self=this;self.data=data;self.types=[];self.create();self.el.addEvents({'change:relay(select, input[type=checkbox])':self.save.bind(self,0),'keyup:relay(input[type=text])':self.save.bind(self,[300])});},create:function(){var self=this;var data=self.data;self.el=new Element('div.profile').adopt(self.delete_button=new Element('span.delete.icon2',{'events':{'click':self.del.bind(self)}}),new Element('.quality_label.ctrlHolder').adopt(new Element('label',{'text':'Name'}),new Element('input.inlay',{'type':'text','value':data.label,'placeholder':'Profile name'})),new Element('div.qualities.ctrlHolder').adopt(new Element('label',{'text':'Search for'}),self.type_container=new Element('ol.types'),new Element('div.formHint',{'html':"Search these qualities (2 minimum), from top to bottom. Use the checkbox, to stop searching after it found this quality."})),new Element('div.wait_for.ctrlHolder').adopt(new Element('span',{'text':'Wait'}),new Element('input.inlay.wait_for_input.xsmall',{'type':'text','value':data.wait_for&&data.wait_for.length>0?data.wait_for[0]:0}),new Element('span',{'text':'day(s) for a better quality '}),new Element('span.advanced',{'text':'and keep searching'}),new Element('input.inlay.xsmall.stop_after_input.advanced',{'type':'text','value':data.stop_after&&data.stop_after.length>0?data.stop_after[0]:0}),new Element('span.advanced',{'text':'day(s) for a better (checked) quality.'}),new Element('span.advanced',{'html':'<br/>Releases need a minimum score of'}),new Element('input.advanced.inlay.xsmall.minimum_score_input',{'size':4,'type':'text','value':data.minimum_score||1})));self.makeSortable();if(data.qualities){data.types=[];data.qualities.each(function(quality,nr){data.types.include({'quality':quality,'finish':data.finish[nr]||false,'3d':data['3d']?data['3d'][nr]||false:false})});}
if(data.types)
data.types.each(self.addType.bind(self));else
self.delete_button.hide();self.addType();},save:function(delay){var self=this;if(self.save_timer)clearTimeout(self.save_timer);self.save_timer=(function(){self.addType();var data=self.getData();if(data.types.length<2)
return;else
self.delete_button.show();Api.request('profile.save',{'data':self.getData(),'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(json){if(json.success){self.data=json.profile;self.type_container.getElement('li:first-child input.finish[type=checkbox]').set('checked',true).getParent().addClass('checked');}}});}).delay(delay,self)},getData:function(){var self=this;var data={'id':self.data._id,'label':self.el.getElement('.quality_label input').get('value'),'wait_for':self.el.getElement('.wait_for_input').get('value'),'stop_after':self.el.getElement('.stop_after_input').get('value'),'minimum_score':self.el.getElement('.minimum_score_input').get('value'),'types':[]};Array.each(self.type_container.getElements('.type'),function(type){if(!type.hasClass('deleted')&&type.getElement('select').get('value')!=-1)
data.types.include({'quality':type.getElement('select').get('value'),'finish':+type.getElement('input.finish[type=checkbox]').checked,'3d':+type.getElement('input.3d[type=checkbox]').checked});});return data},addType:function(data){var self=this;var has_empty=false;self.types.each(function(type){if($(type).hasClass('is_empty'))
has_empty=true;});if(has_empty)return;var t=new Profile.Type(data,{'onChange':self.save.bind(self,0)});$(t).inject(self.type_container);self.sortable.addItems($(t));self.types.include(t);},getTypes:function(){var self=this;return self.types.filter(function(type){return type.get('quality')});},del:function(){var self=this;var label=self.el.getElement('.quality_label input').get('value');var qObj=new Question('Are you sure you want to delete <strong>"'+label+'"</strong>?','Items using this profile, will be set to the default quality.',[{'text':'Delete "'+label+'"','class':'delete','events':{'click':function(e){(e).preventDefault();Api.request('profile.delete',{'data':{'id':self.data._id},'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(json){if(json.success){qObj.close();self.el.destroy();}else{alert(json.message);}}});}}},{'text':'Cancel','cancel':true}]);},makeSortable:function(){var self=this;self.sortable=new Sortables(self.type_container,{'revert':true,'handle':'.handle','opacity':0.5,'onComplete':self.save.bind(self,300)});},get:function(attr){return this.data[attr]},isCore:function(){return this.data.core},toElement:function(){return this.el}});Profile.Type=new Class({Implements:[Events,Options],deleted:false,initialize:function(data,options){var self=this;self.setOptions(options);self.data=data||{};self.create();self.addEvent('change',function(){self.el[self.qualities.get('value')=='-1'?'addClass':'removeClass']('is_empty');self.el[Quality.getQuality(self.qualities.get('value')).allow_3d?'addClass':'removeClass']('allow_3d');self.deleted=self.qualities.get('value')=='-1';});},create:function(){var self=this;var data=self.data;self.el=new Element('li.type').adopt(new Element('span.quality_type').grab(self.fillQualities()),self.finish_container=new Element('label.finish').adopt(new Element('span.finish').grab(self.finish=new Element('input.inlay.finish[type=checkbox]',{'checked':data.finish!==undefined?data.finish:1,'events':{'change':function(){if(self.el==self.el.getParent().getElement(':first-child')){self.finish_class.check();alert('Top quality always finishes the search');return;}
self.fireEvent('change');}}})),new Element('span.check_label[text=finish]')),self['3d_container']=new Element('label.threed').adopt(new Element('span.3d').grab(self['3d']=new Element('input.inlay.3d[type=checkbox]',{'checked':data['3d']!==undefined?data['3d']:0,'events':{'change':function(){self.fireEvent('change');}}})),new Element('span.check_label[text=3D]')),new Element('span.delete.icon2',{'events':{'click':self.del.bind(self)}}),new Element('span.handle'));self.el[self.data.quality?'removeClass':'addClass']('is_empty');if(self.data.quality&&Quality.getQuality(self.data.quality).allow_3d)
self.el.addClass('allow_3d');self.finish_class=new Form.Check(self.finish);self['3d_class']=new Form.Check(self['3d']);},fillQualities:function(){var self=this;self.qualities=new Element('select',{'events':{'change':self.fireEvent.bind(self,'change')}}).grab(new Element('option',{'text':'+ Add another quality','value':-1}));Object.each(Quality.qualities,function(q){new Element('option',{'text':q.label,'value':q.identifier,'data-allow_3d':q.allow_3d}).inject(self.qualities)});self.qualities.set('value',self.data.quality);return self.qualities;},getData:function(){var self=this;return{'quality':self.qualities.get('value'),'finish':+self.finish.checked,'3d':+self['3d'].checked}},get:function(key){return this.data[key];},del:function(){var self=this;self.el.addClass('deleted');self.el.hide();self.deleted=true;self.fireEvent('change');},toElement:function(){return this.el;}});

// /opt/couchpotato/couchpotato/core/plugins/quality/static/quality.js:1432482254
var QualityBase=new Class({tab:'',content:'',setup:function(data){var self=this;self.qualities=data.qualities;self.profiles_list=null;self.profiles=[];Array.each(data.profiles,self.createProfilesClass.bind(self));App.addEvent('loadSettings',self.addSettings.bind(self))},getProfile:function(id){return this.profiles.filter(function(profile){return profile.data._id==id}).pick()},getActiveProfiles:function(){return Array.filter(this.profiles,function(profile){return!profile.data.hide});},getQuality:function(identifier){try{return this.qualities.filter(function(q){return q.identifier==identifier;}).pick();}
catch(e){}
return{}},addSettings:function(){var self=this;self.settings=App.getPage('Settings');self.settings.addEvent('create',function(){var tab=self.settings.createSubTab('profile',{'label':'Quality','name':'profile','subtab_label':'Qualities'},self.settings.tabs.searcher,'searcher');self.tab=tab.tab;self.content=tab.content;self.createProfiles();self.createProfileOrdering();self.createSizes();})},createProfiles:function(){var self=this;var non_core_profiles=Array.filter(self.profiles,function(profile){return!profile.isCore()});var count=non_core_profiles.length;self.settings.createGroup({'label':'Quality Profiles','description':'Create your own profiles with multiple qualities.'}).inject(self.content).adopt(self.profile_container=new Element('div.container'),new Element('a.add_new_profile',{'text':count>0?'Create another quality profile':'Click here to create a quality profile.','events':{'click':function(){var profile=self.createProfilesClass();$(profile).inject(self.profile_container)}}}));Array.each(non_core_profiles,function(profile){$(profile).inject(self.profile_container)});},createProfilesClass:function(data){var self=this;var data=data||{'id':randomString()};var profile=new Profile(data);self.profiles.include(profile);return profile;},createProfileOrdering:function(){var self=this;self.settings.createGroup({'label':'Profile Defaults','description':'(Needs refresh \''+(App.isMac()?'CMD+R':'F5')+'\' after editing)'}).adopt(new Element('.ctrlHolder#profile_ordering').adopt(new Element('label[text=Order]'),self.profiles_list=new Element('ul'),new Element('p.formHint',{'html':'Change the order the profiles are in the dropdown list. Uncheck to hide it completely.<br />First one will be default.'}))).inject(self.content);Array.each(self.profiles,function(profile){var check;new Element('li',{'data-id':profile.data._id}).adopt(check=new Element('input.inlay[type=checkbox]',{'checked':!profile.data.hide,'events':{'change':self.saveProfileOrdering.bind(self)}}),new Element('span.profile_label',{'text':profile.data.label}),new Element('span.handle')).inject(self.profiles_list);new Form.Check(check);});var sorted_changed=false;self.profile_sortable=new Sortables(self.profiles_list,{'revert':true,'handle':'.handle','opacity':0.5,'onSort':function(){sorted_changed=true;},'onComplete':function(){if(sorted_changed){self.saveProfileOrdering();sorted_changed=false;}}});},saveProfileOrdering:function(){var self=this,ids=[],hidden=[];self.profiles_list.getElements('li').each(function(el,nr){ids.include(el.get('data-id'));hidden[nr]=+!el.getElement('input[type=checkbox]').get('checked');});Api.request('profile.save_order',{'data':{'ids':ids,'hidden':hidden}});},createSizes:function(){var self=this;var group=self.settings.createGroup({'label':'Sizes','description':'Edit the minimal and maximum sizes (in MB) for each quality.','advanced':true,'name':'sizes'}).inject(self.content);new Element('div.item.head.ctrlHolder').adopt(new Element('span.label',{'text':'Quality'}),new Element('span.min',{'text':'Min'}),new Element('span.max',{'text':'Max'})).inject(group);Array.each(self.qualities,function(quality){new Element('div.ctrlHolder.item').adopt(new Element('span.label',{'text':quality.label}),new Element('input.min.inlay[type=text]',{'value':quality.size_min,'events':{'keyup':function(e){self.changeSize(quality.identifier,'size_min',e.target.get('value'))}}}),new Element('input.max.inlay[type=text]',{'value':quality.size_max,'events':{'keyup':function(e){self.changeSize(quality.identifier,'size_max',e.target.get('value'))}}})).inject(group)});},size_timer:{},changeSize:function(identifier,type,value){var self=this;if(self.size_timer[identifier+type])clearTimeout(self.size_timer[identifier+type]);self.size_timer[identifier+type]=(function(){Api.request('quality.size.save',{'data':{'identifier':identifier,'value_type':type,'value':value}});}).delay(300)}});window.Quality=new QualityBase();

// /opt/couchpotato/couchpotato/core/plugins/userscript/static/userscript.js:1432482254
Page.Userscript=new Class({Extends:PageBase,order:80,name:'userscript',has_tab:false,options:{'onOpened':function(){App.fireEvent('unload');App.getBlock('header').hide();}},indexAction:function(){var self=this;self.el.adopt(self.frame=new Element('div.frame.loading',{'text':'Loading...'}));var url=window.location.href.split('url=')[1];Api.request('userscript.add_via_url',{'data':{'url':url},'onComplete':function(json){self.frame.empty();self.frame.removeClass('loading');if(json.error)
self.frame.set('html',json.error);else{var item=new Block.Search.MovieItem(json.movie);self.frame.adopt(item);item.showOptions();}}});}});var UserscriptSettingTab=new Class({tab:'',content:'',initialize:function(){var self=this;App.addEvent('loadSettings',self.addSettings.bind(self))},addSettings:function(){var self=this;self.settings=App.getPage('Settings');self.settings.addEvent('create',function(){var host_url=window.location.protocol+'//'+window.location.host;self.settings.createGroup({'name':'userscript','label':'Install the browser extension or bookmarklet','description':'Easily add movies via imdb.com, appletrailers and more'}).inject(self.settings.tabs.automation.content,'top').adopt(new Element('a.userscript.button',{'text':'Install extension','href':'https://couchpota.to/extension/','target':'_blank'}),new Element('span.or[text=or]'),new Element('span.bookmarklet').adopt(new Element('a.button.green',{'text':'+CouchPotato','href':"javascript:void((function(){var e=document.createElement('script');e.setAttribute('type','text/javascript');e.setAttribute('charset','UTF-8');e.setAttribute('src','"+
host_url+Api.createUrl('userscript.bookmark')+"?host="+encodeURI(host_url+Api.createUrl('userscript.get')+randomString()+'/')+"&r='+Math.random()*99999999);document.body.appendChild(e)})());",'target':'','events':{'click':function(e){(e).stop();alert('Drag it to your bookmark ;)')}}}),new Element('span',{'text':'â‡½ Drag this to your bookmarks'}))).setStyles({'background-image':"url('https://couchpota.to/media/images/userscript.gif')"});});}});window.addEvent('domready',function(){new UserscriptSettingTab();});window.addEvent('load',function(){var your_version=$(document.body).get('data-userscript_version'),latest_version=App.getOption('userscript_version')||'',key='cp_version_check',checked_already=Cookie.read(key);if(your_version&&your_version<latest_version&&checked_already<latest_version){if(confirm("Update to the latest Userscript?\nYour version: "+your_version+', new version: '+latest_version)){document.location=Api.createUrl('userscript.get')+randomString()+'/couchpotato.user.js';}
Cookie.write(key,latest_version,{duration:100});}});

// /opt/couchpotato/couchpotato/core/plugins/wizard/static/wizard.js:1432482254
Page.Wizard=new Class({Extends:Page.Settings,order:70,name:'wizard',has_tab:false,wizard_only:true,headers:{'welcome':{'title':'Welcome to the new CouchPotato','description':'To get started, fill in each of the following settings as much as you can.','content':new Element('div',{'styles':{'margin':'0 0 0 30px'}})},'general':{'title':'General','description':'If you want to access CP from outside your local network, you better secure it a bit with a username & password.'},'downloaders':{'title':'What download apps are you using?','description':'CP needs an external download app to work with. Choose one below. For more downloaders check settings after you have filled in the wizard. If your download app isn\'t in the list, use the default Blackhole.'},'searcher':{'label':'Providers','title':'Are you registered at any of these sites?','description':'CP uses these sites to search for movies. A few free are enabled by default, but it\'s always better to have more.'},'renamer':{'title':'Move & rename the movies after downloading?','description':'The coolest part of CP is that it can move and organize your downloaded movies automagically. Check settings and you can even download trailers, subtitles and other data when it has finished downloading. It\'s awesome!'},'automation':{'title':'Easily add movies to your wanted list!','description':'You can easily add movies from your favorite movie site, like IMDB, Rotten Tomatoes, Apple Trailers and more. Just install the extension or drag the bookmarklet to your bookmarks.'+'<br />Once installed, just click the bookmarklet on a movie page and watch the magic happen ;)','content':function(){return App.createUserscriptButtons().setStyles({'background-image':"url('https://couchpota.to/media/images/userscript.gif')"})}},'finish':{'title':'Finishing Up','description':'Are you done? Did you fill in everything as much as possible?'+'<br />Be sure to check the settings to see what more CP can do!<br /><br />'+'<div class="wizard_support">After you\'ve used CP for a while, and you like it (which of course you will), consider supporting CP. Maybe even by writing some code. <br />Or by getting a subscription at <a href="https://usenetserver.com/partners/?a_aid=couchpotato&a_bid=3f357c6f">Usenet Server</a> or <a href="http://www.newshosting.com/partners/?a_aid=couchpotato&a_bid=a0b022df">Newshosting</a>.</div>','content':new Element('div').adopt(new Element('a.button.green',{'styles':{'margin-top':20},'text':'I\'m ready to start the awesomeness, wow this button is big and green!','events':{'click':function(e){(e).preventDefault();Api.request('settings.save',{'data':{'section':'core','name':'show_wizard','value':0},'useSpinner':true,'spinnerOptions':{'target':self.el},'onComplete':function(){window.location=App.createUrl('wanted');}});}}}))}},groups:['welcome','general','downloaders','searcher','renamer','automation','finish'],open:function(action,params){var self=this;if(!self.initialized){App.fireEvent('unload');App.getBlock('header').hide();self.parent(action,params);self.addEvent('create',function(){self.orderGroups();});self.initialized=true;self.scroll=new Fx.Scroll(document.body,{'transition':'quint:in:out'});}
else
(function(){var sc=self.el.getElement('.wgroup_'+action);self.scroll.start(0,sc.getCoordinates().top-80);}).delay(1)},orderGroups:function(){var self=this;var form=self.el.getElement('.uniForm');var tabs=self.el.getElement('.tabs');self.groups.each(function(group){if(self.headers[group]){var group_container=new Element('.wgroup_'+group,{'styles':{'opacity':0.2},'tween':{'duration':350}});if(self.headers[group].include){self.headers[group].include.each(function(inc){group_container.addClass('wgroup_'+inc);})}
var content=self.headers[group].content;group_container.adopt(new Element('h1',{'text':self.headers[group].title}),self.headers[group].description?new Element('span.description',{'html':self.headers[group].description}):null,content?(typeOf(content)=='function'?content():content):null).inject(form);}
var tab_navigation=tabs.getElement('.t_'+group);if(!tab_navigation&&self.headers[group]&&self.headers[group].include){tab_navigation=[];self.headers[group].include.each(function(inc){tab_navigation.include(tabs.getElement('.t_'+inc));})}
if(tab_navigation&&group_container){tabs.adopt(tab_navigation);if(self.headers[group]&&self.headers[group].include){self.headers[group].include.each(function(inc){self.el.getElement('.tab_'+inc).inject(group_container);});new Element('li.t_'+group).adopt(new Element('a',{'href':App.createUrl('wizard/'+group),'text':(self.headers[group].label||group).capitalize()})).inject(tabs)}
else
self.el.getElement('.tab_'+group).inject(group_container);if(tab_navigation.getElement&&self.headers[group]){var a=tab_navigation.getElement('a');a.set('text',(self.headers[group].label||group).capitalize());var url_split=a.get('href').split('wizard')[1].split('/');if(url_split.length>3)
a.set('href',a.get('href').replace(url_split[url_split.length-3]+'/',''));}}
else{new Element('li.t_'+group).adopt(new Element('a',{'href':App.createUrl('wizard/'+group),'text':(self.headers[group].label||group).capitalize()})).inject(tabs);}
if(self.headers[group]&&self.headers[group].event)
self.headers[group].event.call()});self.el.getElement('.advanced_toggle').destroy();self.el.getElement('.section_nzb').hide();new Element('.tab_wrapper').wraps(tabs);var minimum=self.el.getSize().y-window.getSize().y;self.groups.each(function(group,nr){var g=self.el.getElement('.wgroup_'+group);if(!g||!g.isVisible())return;var t=self.el.getElement('.t_'+group);if(!t)return;var func=function(){self.groups.each(function(groups2,nr2){var t2=self.el.getElement('.t_'+groups2);t2[nr2>nr?'removeClass':'addClass']('done');});g.tween('opacity',1);};if(nr==0)
func();new ScrollSpy({min:function(){var c=g.getCoordinates();var top=c.top-(window.getSize().y/2);return top>minimum?minimum:top},max:function(){var c=g.getCoordinates();return c.top+(c.height/2)},onEnter:func,onLeave:function(){g.tween('opacity',0.2)}});});}});

// /opt/couchpotato/couchpotato/core/downloaders/putio/static/putio.js:1432482254
var PutIODownloader=new Class({initialize:function(){var self=this;App.addEvent('loadSettings',self.addRegisterButton.bind(self));},addRegisterButton:function(){var self=this;var setting_page=App.getPage('Settings');setting_page.addEvent('create',function(){var fieldset=setting_page.tabs.downloaders.groups.putio,l=window.location;var putio_set=0;fieldset.getElements('input[type=text]').each(function(el){putio_set+=+(el.get('value')!='');});new Element('.ctrlHolder').adopt((putio_set>0)?[self.unregister=new Element('a.button.red',{'text':'Unregister "'+fieldset.getElement('input[name*=oauth_token]').get('value')+'"','events':{'click':function(){fieldset.getElements('input[name*=oauth_token]').set('value','').fireEvent('change');self.unregister.destroy();self.unregister_or.destroy();}}}),self.unregister_or=new Element('span[text=or]')]:null,new Element('a.button',{'text':putio_set>0?'Register a different account':'Register your put.io account','events':{'click':function(){Api.request('downloader.putio.auth_url',{'data':{'host':l.protocol+'//'+l.hostname+(l.port?':'+l.port:'')},'onComplete':function(json){window.location=json.url;}});}}})).inject(fieldset.getElement('.test_button'),'before');})}});window.addEvent('domready',function(){new PutIODownloader();});

// /opt/couchpotato/couchpotato/core/notifications/core/static/notification.js:1432482254
var NotificationBase=new Class({Extends:BlockBase,Implements:[Options,Events],initialize:function(options){var self=this;self.setOptions(options);App.addEvent('unload',self.stopPoll.bind(self));App.addEvent('reload',self.startInterval.bind(self,[true]));App.on('notification',self.notify.bind(self));App.on('message',self.showMessage.bind(self));App.addEvent('loadSettings',self.addTestButtons.bind(self));self.notifications=[];App.addEvent('load',function(){App.block.notification=new Block.Menu(self,{'button_class':'icon2.eye-open','class':'notification_menu','onOpen':self.markAsRead.bind(self)});$(App.block.notification).inject(App.getBlock('search'),'after');self.badge=new Element('div.badge').inject(App.block.notification,'top').hide();});window.addEvent('load',function(){self.startInterval.delay($(window).getSize().x<=480?2000:100,self);})},notify:function(result){var self=this;var added=new Date();added.setTime(result.added*1000);result.el=App.getBlock('notification').addLink(new Element('span.'+(result.read?'read':'')).adopt(new Element('span.message',{'html':result.message}),new Element('span.added',{'text':added.timeDiffInWords(),'title':added})),'top');self.notifications.include(result);if((result.important!==undefined||result.sticky!==undefined)&&!result.read){var sticky=true;App.trigger('message',[result.message,sticky,result])}
else if(!result.read){self.setBadge(self.notifications.filter(function(n){return!n.read}).length)}},setBadge:function(value){var self=this;self.badge.set('text',value);self.badge[value?'show':'hide']()},markAsRead:function(force_ids){var self=this,ids=force_ids;if(!force_ids){var rn=self.notifications.filter(function(n){return!n.read&&n.important===undefined});var ids=[];rn.each(function(n){ids.include(n._id)})}
if(ids.length>0)
Api.request('notification.markread',{'data':{'ids':ids.join(',')},'onSuccess':function(){self.setBadge('')}})},startInterval:function(force){var self=this;if(self.stopped&&!force){self.stopped=false;return;}
self.request=Api.request('notification.listener',{'data':{'init':true},'onSuccess':function(json){self.processData(json,true)}}).send();setInterval(function(){if(self.request&&self.request.isRunning()){self.request.cancel();self.startPoll()}},120000);},startPoll:function(){var self=this;if(self.stopped)
return;if(self.request&&self.request.isRunning())
self.request.cancel();self.request=Api.request('nonblock/notification.listener',{'onSuccess':function(json){self.processData(json,false)},'data':{'last_id':self.last_id},'onFailure':function(){self.startPoll.delay(2000,self)}}).send()},stopPoll:function(){if(this.request)
this.request.cancel();this.stopped=true;},processData:function(json,init){var self=this;if(json&&json.result){Array.each(json.result,function(result){App.trigger(result._t||result.type,[result]);if(result.message&&result.read===undefined&&!init)
self.showMessage(result.message);});if(json.result.length>0)
self.last_id=json.result.getLast().message_id}
self.startPoll.delay(1500,self);},showMessage:function(message,sticky,data){var self=this;if(!self.message_container)
self.message_container=new Element('div.messages').inject(document.body);var new_message=new Element('div',{'class':'message'+(sticky?' sticky':''),'html':message}).inject(self.message_container,'top');setTimeout(function(){new_message.addClass('show')},10);var hide_message=function(){new_message.addClass('hide');setTimeout(function(){new_message.destroy();},1000);};if(sticky)
new_message.grab(new Element('a.close.icon2',{'events':{'click':function(){self.markAsRead([data._id]);hide_message();}}}));else
setTimeout(hide_message,4000);},addTestButtons:function(){var self=this;var setting_page=App.getPage('Settings');setting_page.addEvent('create',function(){Object.each(setting_page.tabs.notifications.groups,self.addTestButton.bind(self))})},addTestButton:function(fieldset,plugin_name){var self=this,button_name=self.testButtonName(fieldset);if(button_name.contains('Notifications'))return;new Element('.ctrlHolder.test_button').adopt(new Element('a.button',{'text':button_name,'events':{'click':function(){var button=fieldset.getElement('.test_button .button');button.set('text','Sending notification');Api.request('notify.'+plugin_name+'.test',{'onComplete':function(json){button.set('text',button_name);if(json.success){var message=new Element('span.success',{'text':'Notification successful'}).inject(button,'after')}
else{var message=new Element('span.failed',{'text':'Notification failed. Check logs for details.'}).inject(button,'after')}
(function(){message.destroy();}).delay(3000)}});}}})).inject(fieldset);},testButtonName:function(fieldset){var name=String(fieldset.getElement('h2').innerHTML).substring(0,String(fieldset.getElement('h2').innerHTML).indexOf("<span"));return'Test '+name;}});window.Notification=new NotificationBase();

// /opt/couchpotato/couchpotato/core/notifications/twitter/static/twitter.js:1432482254
var TwitterNotification=new Class({initialize:function(){var self=this;App.addEvent('loadSettings',self.addRegisterButton.bind(self));},addRegisterButton:function(){var self=this;var setting_page=App.getPage('Settings');setting_page.addEvent('create',function(){var fieldset=setting_page.tabs.notifications.groups.twitter,l=window.location;var twitter_set=0;fieldset.getElements('input[type=text]').each(function(el){twitter_set+=+(el.get('value')!='');});new Element('.ctrlHolder').adopt((twitter_set>0)?[self.unregister=new Element('a.button.red',{'text':'Unregister "'+fieldset.getElement('input[name*=screen_name]').get('value')+'"','events':{'click':function(){fieldset.getElements('input[type=text]').set('value','').fireEvent('change');self.unregister.destroy();self.unregister_or.destroy();}}}),self.unregister_or=new Element('span[text=or]')]:null,new Element('a.button',{'text':twitter_set>0?'Register a different account':'Register your Twitter account','events':{'click':function(){Api.request('notify.twitter.auth_url',{'data':{'host':l.protocol+'//'+l.hostname+(l.port?':'+l.port:'')},'onComplete':function(json){window.location=json.url;}});}}})).inject(fieldset.getElement('.test_button'),'before');})}});window.addEvent('domready',function(){new TwitterNotification();});

// /opt/couchpotato/couchpotato/core/media/_base/search/static/search.js:1432482254
Block.Search=new Class({Extends:BlockBase,cache:{},create:function(){var self=this;var focus_timer=0;self.el=new Element('div.search_form').adopt(new Element('div.input').adopt(self.input=new Element('input',{'placeholder':'Search & add a new media','events':{'input':self.keyup.bind(self),'paste':self.keyup.bind(self),'change':self.keyup.bind(self),'keyup':self.keyup.bind(self),'focus':function(){if(focus_timer)clearTimeout(focus_timer);self.el.addClass('focused');if(this.get('value'))
self.hideResults(false)},'blur':function(){focus_timer=(function(){self.el.removeClass('focused')}).delay(100);}}}),new Element('a.icon2',{'events':{'click':self.clear.bind(self),'touchend':self.clear.bind(self)}})),self.result_container=new Element('div.results_container',{'tween':{'duration':200},'events':{'mousewheel':function(e){(e).stopPropagation();}}}).adopt(self.results=new Element('div.results')));self.mask=new Element('div.mask').inject(self.result_container).fade('hide');},clear:function(e){var self=this;(e).preventDefault();if(self.last_q===''){self.input.blur();self.last_q=null;}
else{self.last_q='';self.input.set('value','');self.input.focus();self.media={};self.results.empty();self.el.removeClass('filled')}},hideResults:function(bool){var self=this;if(self.hidden==bool)return;self.el[bool?'removeClass':'addClass']('shown');if(bool){History.removeEvent('change',self.hideResults.bind(self,!bool));self.el.removeEvent('outerClick',self.hideResults.bind(self,!bool));}
else{History.addEvent('change',self.hideResults.bind(self,!bool));self.el.addEvent('outerClick',self.hideResults.bind(self,!bool));}
self.hidden=bool;},keyup:function(){var self=this;self.el[self.q()?'addClass':'removeClass']('filled');if(self.q()!=self.last_q){if(self.api_request&&self.api_request.isRunning())
self.api_request.cancel();if(self.autocomplete_timer)clearTimeout(self.autocomplete_timer);self.autocomplete_timer=self.autocomplete.delay(300,self)}},autocomplete:function(){var self=this;if(!self.q()){self.hideResults(true);return}
self.list()},list:function(){var self=this,q=self.q(),cache=self.cache[q];self.hideResults(false);if(!cache){self.mask.fade('in');if(!self.spinner)
self.spinner=createSpinner(self.mask);self.api_request=Api.request('search',{'data':{'q':q},'onComplete':self.fill.bind(self,q)})}
else
self.fill(q,cache);self.last_q=q;},fill:function(q,json){var self=this;self.cache[q]=json;self.media={};self.results.empty();Object.each(json,function(media){if(typeOf(media)=='array'){Object.each(media,function(m){var m=new Block.Search[m.type.capitalize()+'Item'](m);$(m).inject(self.results);self.media[m.imdb||'r-'+Math.floor(Math.random()*10000)]=m;if(q==m.imdb)
m.showOptions()});}});var w=window.getSize(),rc=self.result_container.getCoordinates();self.results.setStyle('max-height',(w.y-rc.top-50)+'px');self.mask.fade('out')},loading:function(bool){this.el[bool?'addClass':'removeClass']('loading')},q:function(){return this.input.get('value').trim();}});

// /opt/couchpotato/couchpotato/core/media/movie/_base/static/list.js:1432482254
var MovieList=new Class({Implements:[Events,Options],options:{navigation:true,limit:50,load_more:true,loader:true,menu:[],add_new:false,force_view:false},movies:[],movies_added:{},total_movies:0,letters:{},filter:null,initialize:function(options){var self=this;self.setOptions(options);self.offset=0;self.filter=self.options.filter||{'starts_with':null,'search':null};self.el=new Element('div.movies').adopt(self.title=self.options.title?new Element('h2',{'text':self.options.title,'styles':{'display':'none'}}):null,self.description=self.options.description?new Element('div.description',{'html':self.options.description,'styles':{'display':'none'}}):null,self.movie_list=new Element('div'),self.load_more=self.options.load_more?new Element('a.load_more',{'events':{'click':self.loadMore.bind(self)}}):null);if($(window).getSize().x<=480&&!self.options.force_view)
self.changeView('list');else
self.changeView(self.getSavedView()||self.options.view||'details');self.getMovies();App.on('movie.added',self.movieAdded.bind(self));App.on('movie.deleted',self.movieDeleted.bind(self))},movieDeleted:function(notification){var self=this;if(self.movies_added[notification.data._id]){self.movies.each(function(movie){if(movie.get('_id')==notification.data._id){movie.destroy();delete self.movies_added[notification.data._id];self.setCounter(self.counter_count-1);self.total_movies--;}})}
self.checkIfEmpty();},movieAdded:function(notification){var self=this;self.fireEvent('movieAdded',notification);if(self.options.add_new&&!self.movies_added[notification.data._id]&&notification.data.status==self.options.status){window.scroll(0,0);self.createMovie(notification.data,'top');self.setCounter(self.counter_count+1);self.checkIfEmpty();}},create:function(){var self=this;if(self.options.navigation)
self.createNavigation();if(self.options.load_more)
self.scrollspy=new ScrollSpy({min:function(){var c=self.load_more.getCoordinates();return c.top-window.document.getSize().y-300},onEnter:self.loadMore.bind(self)});self.created=true;},addMovies:function(movies,total){var self=this;if(!self.created)self.create();if(movies.length<self.options.limit&&self.scrollspy){self.load_more.hide();self.scrollspy.stop();}
Object.each(movies,function(movie){self.createMovie(movie);});self.total_movies+=total;self.setCounter(total);},setCounter:function(count){var self=this;if(!self.navigation_counter)return;self.counter_count=count;self.navigation_counter.set('text',(count||0)+' movies');if(self.empty_message){self.empty_message.destroy();self.empty_message=null;}
if(self.total_movies&&count==0&&!self.empty_message){var message=(self.filter.search?'for "'+self.filter.search+'"':'')+
(self.filter.starts_with?' in <strong>'+self.filter.starts_with+'</strong>':'');self.empty_message=new Element('.message',{'html':'No movies found '+message+'.<br/>'}).grab(new Element('a',{'text':'Reset filter','events':{'click':function(){self.filter={'starts_with':null,'search':null};self.navigation_search_input.set('value','');self.reset();self.activateLetter();self.getMovies(true);self.last_search_value='';}}})).inject(self.movie_list);}},createMovie:function(movie,inject_at){var self=this;var m=new Movie(self,{'actions':self.options.actions,'view':self.current_view,'onSelect':self.calculateSelected.bind(self)},movie);$(m).inject(self.movie_list,inject_at||'bottom');m.fireEvent('injected');self.movies.include(m);self.movies_added[movie._id]=true;},createNavigation:function(){var self=this;var chars='#ABCDEFGHIJKLMNOPQRSTUVWXYZ';self.el.addClass('with_navigation');self.navigation=new Element('div.alph_nav').adopt(self.mass_edit_form=new Element('div.mass_edit_form').adopt(new Element('span.select').adopt(self.mass_edit_select=new Element('input[type=checkbox].inlay',{'events':{'change':self.massEditToggleAll.bind(self)}}),self.mass_edit_selected=new Element('span.count',{'text':0}),self.mass_edit_selected_label=new Element('span',{'text':'selected'})),new Element('div.quality').adopt(self.mass_edit_quality=new Element('select'),new Element('a.button.orange',{'text':'Change quality','events':{'click':self.changeQualitySelected.bind(self)}})),new Element('div.delete').adopt(new Element('span[text=or]'),new Element('a.button.red',{'text':'Delete','events':{'click':self.deleteSelected.bind(self)}})),new Element('div.refresh').adopt(new Element('span[text=or]'),new Element('a.button.green',{'text':'Refresh','events':{'click':self.refreshSelected.bind(self)}}))),new Element('div.menus').adopt(self.navigation_counter=new Element('span.counter[title=Total]'),self.filter_menu=new Block.Menu(self,{'class':'filter'}),self.navigation_actions=new Element('ul.actions',{'events':{'click:relay(li)':function(e,el){var a='active';self.navigation_actions.getElements('.'+a).removeClass(a);self.changeView(el.get('data-view'));this.addClass(a);el.inject(el.getParent(),'top');el.getSiblings().hide();setTimeout(function(){el.getSiblings().setStyle('display',null);},100)}}}),self.navigation_menu=new Block.Menu(self,{'class':'extra'}))).inject(self.el,'top');self.mass_edit_select_class=new Form.Check(self.mass_edit_select);Quality.getActiveProfiles().each(function(profile){new Element('option',{'value':profile.get('_id'),'text':profile.get('label')}).inject(self.mass_edit_quality)});self.filter_menu.addLink(self.navigation_search_input=new Element('input',{'title':'Search through '+self.options.identifier,'placeholder':'Search through '+self.options.identifier,'events':{'keyup':self.search.bind(self),'change':self.search.bind(self)}})).addClass('search');var available_chars;self.filter_menu.addEvent('open',function(){self.navigation_search_input.focus();if(!available_chars&&(self.navigation.isDisplayed()||self.navigation.isVisible()))
Api.request('media.available_chars',{'data':Object.merge({'status':self.options.status},self.filter),'onSuccess':function(json){available_chars=json.chars;available_chars.each(function(c){self.letters[c.capitalize()].addClass('available')})}});});self.filter_menu.addLink(self.navigation_alpha=new Element('ul.numbers',{'events':{'click:relay(li.available)':function(e,el){self.activateLetter(el.get('data-letter'));self.getMovies(true)}}}));['mass_edit','details','list'].each(function(view){var current=self.current_view==view;new Element('li',{'class':'icon2 '+view+(current?' active ':''),'data-view':view}).inject(self.navigation_actions,current?'top':'bottom');});self.letters['all']=new Element('li.letter_all.available.active',{'text':'ALL'}).inject(self.navigation_alpha);chars.split('').each(function(c){self.letters[c]=new Element('li',{'text':c,'class':'letter_'+c,'data-letter':c}).inject(self.navigation_alpha);});if(self.options.menu.length>0)
self.options.menu.each(function(menu_item){self.navigation_menu.addLink(menu_item);});else
self.navigation_menu.hide();},calculateSelected:function(){var self=this;var selected=0,movies=self.movies.length;self.movies.each(function(movie){selected+=movie.isSelected()?1:0});var indeterminate=selected>0&&selected<movies,checked=selected==movies&&selected>0;self.mass_edit_select.set('indeterminate',indeterminate);self.mass_edit_select_class[checked?'check':'uncheck']();self.mass_edit_select_class.element[indeterminate?'addClass':'removeClass']('indeterminate');self.mass_edit_selected.set('text',selected);},deleteSelected:function(){var self=this,ids=self.getSelectedMovies(),help_msg=self.identifier=='wanted'?'If you do, you won\'t be able to watch them, as they won\'t get downloaded!':'Your files will be safe, this will only delete the reference from the CouchPotato manage list';var qObj=new Question('Are you sure you want to delete '+ids.length+' movie'+(ids.length!=1?'s':'')+'?',help_msg,[{'text':'Yes, delete '+(ids.length!=1?'them':'it'),'class':'delete','events':{'click':function(e){(e).preventDefault();this.set('text','Deleting..');Api.request('media.delete',{'method':'post','data':{'id':ids.join(','),'delete_from':self.options.identifier},'onSuccess':function(){qObj.close();var erase_movies=[];self.movies.each(function(movie){if(movie.isSelected()){$(movie).destroy();erase_movies.include(movie);}});erase_movies.each(function(movie){self.movies.erase(movie);movie.destroy();self.setCounter(self.counter_count-1);self.total_movies--;});self.calculateSelected();}});}}},{'text':'Cancel','cancel':true}]);},changeQualitySelected:function(){var self=this;var ids=self.getSelectedMovies();Api.request('movie.edit',{'method':'post','data':{'id':ids.join(','),'profile_id':self.mass_edit_quality.get('value')},'onSuccess':self.search.bind(self)});},refreshSelected:function(){var self=this;var ids=self.getSelectedMovies();Api.request('media.refresh',{'method':'post','data':{'id':ids.join(',')}});},getSelectedMovies:function(){var self=this;var ids=[];self.movies.each(function(movie){if(movie.isSelected())
ids.include(movie.get('_id'))});return ids},massEditToggleAll:function(){var self=this;var select=self.mass_edit_select.get('checked');self.movies.each(function(movie){movie.select(select)});self.calculateSelected()},reset:function(){var self=this;self.movies=[];if(self.mass_edit_select)
self.calculateSelected();if(self.navigation_alpha)
self.navigation_alpha.getElements('.active').removeClass('active');self.offset=0;if(self.scrollspy){self.scrollspy.start();}},activateLetter:function(letter){var self=this;self.reset();self.letters[letter||'all'].addClass('active');self.filter.starts_with=letter;},changeView:function(new_view){var self=this;self.el.removeClass(self.current_view+'_list').addClass(new_view+'_list');self.current_view=new_view;Cookie.write(self.options.identifier+'_view2',new_view,{duration:1000});},getSavedView:function(){var self=this;return Cookie.read(self.options.identifier+'_view2');},search:function(){var self=this;if(self.search_timer)clearTimeout(self.search_timer);self.search_timer=(function(){var search_value=self.navigation_search_input.get('value');if(search_value==self.last_search_value)return;self.reset();self.activateLetter();self.filter.search=search_value;self.getMovies(true);self.last_search_value=search_value;}).delay(250);},update:function(){var self=this;self.reset();self.getMovies(true);},getMovies:function(reset){var self=this;if(self.scrollspy){self.scrollspy.stop();self.load_more.set('text','loading...');}
if(self.movies.length==0&&self.options.loader){self.loader_first=new Element('div.loading').adopt(new Element('div.message',{'text':self.options.title?'Loading \''+self.options.title+'\'':'Loading...'})).inject(self.el,'top');createSpinner(self.loader_first,{radius:4,length:4,width:1});self.el.setStyle('min-height',93);}
Api.request(self.options.api_call||'media.list',{'data':Object.merge({'type':self.options.type||'movie','status':self.options.status,'limit_offset':self.options.limit?self.options.limit+','+self.offset:null},self.filter),'onSuccess':function(json){if(reset)
self.movie_list.empty();if(self.loader_first){var lf=self.loader_first;self.loader_first.addClass('hide');self.loader_first=null;setTimeout(function(){lf.destroy();},20000);self.el.setStyle('min-height',null);}
self.store(json.movies);self.addMovies(json.movies,json.total||json.movies.length);if(self.scrollspy){self.load_more.set('text','load more movies');self.scrollspy.start();}
self.checkIfEmpty();self.fireEvent('loaded');}});},loadMore:function(){var self=this;if(self.offset>=self.options.limit)
self.getMovies()},store:function(movies){var self=this;self.offset+=movies.length;},checkIfEmpty:function(){var self=this;var is_empty=self.movies.length==0&&(self.total_movies==0||self.total_movies===undefined);if(self.title)
self.title[is_empty?'hide':'show']();if(self.description)
self.description.setStyle('display',[is_empty?'none':'']);if(is_empty&&self.options.on_empty_element){self.options.on_empty_element.inject(self.loader_first||self.title||self.movie_list,'after');if(self.navigation)
self.navigation.hide();self.empty_element=self.options.on_empty_element;}
else if(self.empty_element){self.empty_element.destroy();if(self.navigation)
self.navigation.show();}},toElement:function(){return this.el;}});

// /opt/couchpotato/couchpotato/core/media/movie/_base/static/movie.js:1432482254
var Movie=new Class({Extends:BlockBase,action:{},initialize:function(list,options,data){var self=this;self.data=data;self.view=options.view||'details';self.list=list;self.el=new Element('div.movie');self.profile=Quality.getProfile(data.profile_id)||{};self.category=CategoryList.getCategory(data.category_id)||{};self.parent(self,options);self.addEvents();},addEvents:function(){var self=this;self.global_events={};self.global_events['movie.update']=function(notification){if(self.data._id!=notification.data._id)return;self.busy(false);self.removeView();self.update.delay(2000,self,notification);};App.on('movie.update',self.global_events['movie.update']);['media.busy','movie.searcher.started'].each(function(listener){self.global_events[listener]=function(notification){if(notification.data&&(self.data._id==notification.data._id||(typeOf(notification.data._id)=='array'&&notification.data._id.indexOf(self.data._id)>-1)))
self.busy(true);};App.on(listener,self.global_events[listener]);});self.global_events['movie.searcher.ended']=function(notification){if(notification.data&&self.data._id==notification.data._id)
self.busy(false)};App.on('movie.searcher.ended',self.global_events['movie.searcher.ended']);self.global_events['release.update_status']=function(notification){var data=notification.data;if(data&&self.data._id==data.media_id){if(!self.data.releases)
self.data.releases=[];var updated=false;self.data.releases.each(function(release){if(release._id==data._id){release['status']=data.status;updated=true;}});if(updated)
self.updateReleases();}};App.on('release.update_status',self.global_events['release.update_status']);},destroy:function(){var self=this;self.el.destroy();delete self.list.movies_added[self.get('id')];self.list.movies.erase(self);self.list.checkIfEmpty();Object.each(self.global_events,function(handle,listener){App.off(listener,handle);});},busy:function(set_busy,timeout){var self=this;if(!set_busy){setTimeout(function(){if(self.spinner){self.mask.fade('out');setTimeout(function(){if(self.mask)
self.mask.destroy();if(self.spinner)
self.spinner.el.destroy();self.spinner=null;self.mask=null;},timeout||400);}},timeout||1000)}
else if(!self.spinner){self.createMask();self.spinner=createSpinner(self.mask);self.mask.fade('in');}},createMask:function(){var self=this;self.mask=new Element('div.mask',{'styles':{'z-index':4}}).inject(self.el,'top').fade('hide');},update:function(notification){var self=this;self.data=notification.data;self.el.empty();self.removeView();self.profile=Quality.getProfile(self.data.profile_id)||{};self.category=CategoryList.getCategory(self.data.category_id)||{};self.create();self.busy(false);},create:function(){var self=this;self.el.addClass('status_'+self.get('status'));var eta=null,eta_date=null,now=Math.round(+new Date()/1000);if(self.data.info.release_date)
[self.data.info.release_date.dvd,self.data.info.release_date.theater].each(function(timestamp){if(timestamp>0&&(eta==null||Math.abs(timestamp-now)<Math.abs(eta-now)))
eta=timestamp;});if(eta){eta_date=new Date(eta*1000);eta_date=eta_date.toLocaleString('en-us',{month:"long"})+' '+eta_date.getFullYear();}
self.el.adopt(self.select_checkbox=new Element('input[type=checkbox].inlay',{'events':{'change':function(){self.fireEvent('select')}}}),self.thumbnail=(self.data.files&&self.data.files.image_poster&&self.data.files.image_poster.length>0)?new Element('img',{'class':'type_image poster','src':Api.createUrl('file.cache')+self.data.files.image_poster[0].split(Api.getOption('path_sep')).pop()}):null,self.data_container=new Element('div.data.inlay.light').adopt(self.info_container=new Element('div.info').adopt(new Element('div.title').adopt(self.title=new Element('span',{'text':self.getTitle()||'n/a'}),self.year=new Element('div.year',{'text':self.data.info.year||'n/a'})),self.description=new Element('div.description.tiny_scroll',{'text':self.data.info.plot}),self.eta=eta_date&&(now+8035200>eta)?new Element('div.eta',{'text':eta_date,'title':'ETA'}):null,self.quality=new Element('div.quality',{'events':{'click':function(e){var releases=self.el.getElement('.actions .releases');if(releases.isVisible())
releases.fireEvent('click',[e])}}})),self.actions=new Element('div.actions')));if(!self.thumbnail)
self.el.addClass('no_thumbnail');self.select_checkbox_class=new Form.Check(self.select_checkbox);if(self.profile.data)
self.profile.getTypes().each(function(type){var q=self.addQuality(type.get('quality'),type.get('3d'));if((type.finish==true||type.get('finish'))&&!q.hasClass('finish')){q.addClass('finish');q.set('title',q.get('title')+' Will finish searching for this movie if this quality is found.')}});self.updateReleases();Object.each(self.options.actions,function(action,key){self.action[key.toLowerCase()]=action=new self.options.actions[key](self);if(action.el)
self.actions.adopt(action)});},updateReleases:function(){var self=this;if(!self.data.releases||self.data.releases.length==0)return;self.data.releases.each(function(release){var q=self.quality.getElement('.q_'+release.quality+(release.is_3d?'.is_3d':':not(.is_3d)')),status=release.status;if(!q&&(status=='snatched'||status=='seeding'||status=='done'))
q=self.addQuality(release.quality,release.is_3d||false);if(q&&!q.hasClass(status)){q.addClass(status);q.set('title',(q.get('title')?q.get('title'):'')+' status: '+status)}});},addQuality:function(quality,is_3d){var self=this;var q=Quality.getQuality(quality);return new Element('span',{'text':q.label+(is_3d?' 3D':''),'class':'q_'+q.identifier+(is_3d?' is_3d':''),'title':''}).inject(self.quality);},getTitle:function(){var self=this;if(self.data.title)
return self.getUnprefixedTitle(self.data.title);else if(self.data.info.titles.length>0)
return self.getUnprefixedTitle(self.data.info.titles[0]);return'Unknown movie'},getUnprefixedTitle:function(t){if(t.substr(0,4).toLowerCase()=='the ')
t=t.substr(4)+', The';else if(t.substr(0,3).toLowerCase()=='an ')
t=t.substr(3)+', An';else if(t.substr(0,2).toLowerCase()=='a ')
t=t.substr(2)+', A';return t;},slide:function(direction,el){var self=this;if(direction=='in'){self.temp_view=self.view;self.changeView('details');self.el.addEvent('outerClick',function(){self.removeView();self.slide('out')});el.show();self.data_container.addClass('hide_right');}
else{self.el.removeEvents('outerClick');setTimeout(function(){if(self.el)
self.el.getElements('> :not(.data):not(.poster):not(.movie_container)').hide();},600);self.data_container.removeClass('hide_right');}},changeView:function(new_view){var self=this;if(self.el)
self.el.removeClass(self.view+'_view').addClass(new_view+'_view');self.view=new_view;},removeView:function(){var self=this;self.el.removeClass(self.view+'_view')},getIdentifier:function(){var self=this;try{return self.get('identifiers').imdb;}
catch(e){}
return self.get('imdb');},get:function(attr){return this.data[attr]||this.data.info[attr]},select:function(bool){var self=this;self.select_checkbox_class[bool?'check':'uncheck']()},isSelected:function(){return this.select_checkbox.get('checked');},toElement:function(){return this.el;}});

// /opt/couchpotato/couchpotato/core/media/movie/_base/static/search.js:1432482254
Block.Search.MovieItem=new Class({Implements:[Options,Events],initialize:function(info,options){var self=this;self.setOptions(options);self.info=info;self.alternative_titles=[];self.create();},create:function(){var self=this,info=self.info;self.el=new Element('div.media_result',{'id':info.imdb}).adopt(self.thumbnail=info.images&&info.images.poster.length>0?new Element('img.thumbnail',{'src':info.images.poster[0],'height':null,'width':null}):null,self.options_el=new Element('div.options.inlay'),self.data_container=new Element('div.data',{'events':{'click':self.showOptions.bind(self)}}).adopt(self.info_container=new Element('div.info').adopt(new Element('h2').adopt(self.title=new Element('span.title',{'text':info.titles&&info.titles.length>0?info.titles[0]:'Unknown'}),self.year=info.year?new Element('span.year',{'text':info.year}):null))));if(info.titles)
info.titles.each(function(title){self.alternativeTitle({'title':title});})},alternativeTitle:function(alternative){var self=this;self.alternative_titles.include(alternative);},getTitle:function(){var self=this;try{return self.info.original_title?self.info.original_title:self.info.titles[0];}
catch(e){return'Unknown';}},get:function(key){return this.info[key]},showOptions:function(){var self=this;self.createOptions();self.data_container.addClass('open');self.el.addEvent('outerClick',self.closeOptions.bind(self))},closeOptions:function(){var self=this;self.data_container.removeClass('open');self.el.removeEvents('outerClick')},add:function(e){var self=this;if(e)
(e).preventDefault();self.loadingMask();Api.request('movie.add',{'data':{'identifier':self.info.imdb,'title':self.title_select.get('value'),'profile_id':self.profile_select.get('value'),'category_id':self.category_select.get('value')},'onComplete':function(json){self.options_el.empty();self.options_el.adopt(new Element('div.message',{'text':json.success?'Movie successfully added.':'Movie didn\'t add properly. Check logs'}));self.mask.fade('out');self.fireEvent('added');},'onFailure':function(){self.options_el.empty();self.options_el.adopt(new Element('div.message',{'text':'Something went wrong, check the logs for more info.'}));self.mask.fade('out');}});},createOptions:function(){var self=this,info=self.info;if(!self.options_el.hasClass('set')){if(info.in_library){var in_library=[];(info.in_library.releases||[]).each(function(release){in_library.include(release.quality)});}
self.options_el.grab(new Element('div',{'class':info.in_wanted&&info.in_wanted.profile_id||in_library?'in_library_wanted':''}).adopt(info.in_wanted&&info.in_wanted.profile_id?new Element('span.in_wanted',{'text':'Already in wanted list: '+Quality.getProfile(info.in_wanted.profile_id).get('label')}):(in_library?new Element('span.in_library',{'text':'Already in library: '+in_library.join(', ')}):null),self.title_select=new Element('select',{'name':'title'}),self.profile_select=new Element('select',{'name':'profile'}),self.category_select=new Element('select',{'name':'category'}).grab(new Element('option',{'value':-1,'text':'None'})),self.add_button=new Element('a.button',{'text':'Add','events':{'click':self.add.bind(self)}})));Array.each(self.alternative_titles,function(alt){new Element('option',{'text':alt.title}).inject(self.title_select)});var categories=CategoryList.getAll();if(categories.length==0)
self.category_select.hide();else{self.category_select.show();categories.each(function(category){new Element('option',{'value':category.data._id,'text':category.data.label}).inject(self.category_select);});}
var profiles=Quality.getActiveProfiles();if(profiles.length==1)
self.profile_select.hide();profiles.each(function(profile){new Element('option',{'value':profile.get('_id'),'text':profile.get('label')}).inject(self.profile_select)});self.options_el.addClass('set');if(categories.length==0&&self.title_select.getElements('option').length==1&&profiles.length==1&&!(self.info.in_wanted&&self.info.in_wanted.profile_id||in_library))
self.add();}},loadingMask:function(){var self=this;self.mask=new Element('div.mask').inject(self.el).fade('hide');createSpinner(self.mask);self.mask.fade('in')},toElement:function(){return this.el}});

// /opt/couchpotato/couchpotato/core/media/movie/_base/static/wanted.js:1432482254
Page.Wanted=new Class({Extends:PageBase,order:10,name:'wanted',title:'Gimmy gimmy gimmy!',folder_browser:null,indexAction:function(){var self=this;if(!self.wanted){self.manual_search=new Element('a',{'title':'Force a search for the full wanted list','text':'Search all wanted','events':{'click':self.doFullSearch.bind(self,true)}});self.scan_folder=new Element('a',{'title':'Scan a folder and rename all movies in it','text':'Manual folder scan','events':{'click':self.scanFolder.bind(self)}});self.wanted=new MovieList({'identifier':'wanted','status':'active','actions':[MA.IMDB,MA.Trailer,MA.Release,MA.Edit,MA.Refresh,MA.Readd,MA.Delete],'add_new':true,'menu':[self.manual_search,self.scan_folder],'on_empty_element':App.createUserscriptButtons().addClass('empty_wanted')});$(self.wanted).inject(self.el);self.startProgressInterval.delay(4000,self);}},doFullSearch:function(){var self=this;if(!self.search_in_progress){Api.request('movie.searcher.full_search');self.startProgressInterval();}},startProgressInterval:function(){var self=this;var start_text=self.manual_search.get('text');self.progress_interval=setInterval(function(){if(self.search_progress&&self.search_progress.running)return;self.search_progress=Api.request('movie.searcher.progress',{'onComplete':function(json){self.search_in_progress=true;if(!json.movie){clearInterval(self.progress_interval);self.search_in_progress=false;self.manual_search.set('text',start_text);}
else{var progress=json.movie;self.manual_search.set('text','Searching.. ('+Math.round(((progress.total-progress.to_go)/progress.total)*100)+'%)');}}});},1000);},scanFolder:function(e){(e).stop();var self=this;var options={'name':'Scan_folder'};if(!self.folder_browser){self.folder_browser=new Option['Directory']("Scan","folder","",options);self.folder_browser.save=function(){var folder=self.folder_browser.getValue();Api.request('renamer.scan',{'data':{'base_folder':folder}});};self.folder_browser.inject(self.el,'top');self.folder_browser.fireEvent('injected');self.folder_browser.directory_inlay.hide();self.folder_browser.el.removeChild(self.folder_browser.el.firstChild);self.folder_browser.showBrowser();self.folder_browser.browser.getElements('.clear.button').hide();self.folder_browser.save_button.text="Select";self.folder_browser.browser.style.zIndex=1000;}
else{self.folder_browser.showBrowser();}}});

// /opt/couchpotato/couchpotato/core/media/movie/_base/static/manage.js:1432482254
Page.Manage=new Class({Extends:PageBase,order:20,name:'manage',title:'Do stuff to your existing movies!',indexAction:function(){var self=this;if(!self.list){self.refresh_button=new Element('a',{'title':'Rescan your library for new movies','text':'Full library refresh','events':{'click':self.refresh.bind(self,true)}});self.refresh_quick=new Element('a',{'title':'Just scan for recently changed','text':'Quick library scan','events':{'click':self.refresh.bind(self,false)}});self.list=new MovieList({'identifier':'manage','filter':{'status':'done','release_status':'done','status_or':1},'actions':[MA.IMDB,MA.Trailer,MA.Files,MA.Readd,MA.Edit,MA.Delete],'menu':[self.refresh_button,self.refresh_quick],'on_empty_element':new Element('div.empty_manage').adopt(new Element('div',{'text':'Seems like you don\'t have anything in your library yet.'}),new Element('div',{'text':'Add your existing movie folders in '}).adopt(new Element('a',{'text':'Settings > Manage','href':App.createUrl('settings/manage')})),new Element('div.after_manage',{'text':'When you\'ve done that, hit this button â†’ '}).adopt(new Element('a.button.green',{'text':'Hit me, but not too hard','events':{'click':self.refresh.bind(self,true)}})))});$(self.list).inject(self.el);self.startProgressInterval();}},refresh:function(full){var self=this;if(!self.update_in_progress){Api.request('manage.update',{'data':{'full':+full}});self.startProgressInterval();}},startProgressInterval:function(){var self=this;self.progress_interval=setInterval(function(){if(self.progress_request&&self.progress_request.running)
return;self.update_in_progress=true;self.progress_request=Api.request('manage.progress',{'onComplete':function(json){if(!json||!json.progress){clearInterval(self.progress_interval);self.update_in_progress=false;if(self.progress_container){self.progress_container.destroy();self.list.update();}}
else{var progress=json.progress;if(!self.list.navigation)
return;if(!self.progress_container)
self.progress_container=new Element('div.progress').inject(self.list.navigation,'after');self.progress_container.empty();var sorted_table=self.parseProgress(json.progress);sorted_table.each(function(folder){var folder_progress=progress[folder];new Element('div').adopt(new Element('span.folder',{'text':folder+
(folder_progress.eta>0?', '+new Date().increment('second',folder_progress.eta).timeDiffInWords().replace('from now','to go'):'')}),new Element('span.percentage',{'text':folder_progress.total?Math.round(((folder_progress.total-folder_progress.to_go)/folder_progress.total)*100)+'%':'0%'})).inject(self.progress_container)});}}})},1000);},parseProgress:function(progress_object){var folder,temp_array=[];for(folder in progress_object){if(progress_object.hasOwnProperty(folder)){temp_array.push(folder)}}
return temp_array.stableSort()}});

// /opt/couchpotato/couchpotato/core/media/movie/_base/static/movie.actions.js:1432482254
var MovieAction=new Class({Implements:[Options],class_name:'action icon2',initialize:function(movie,options){var self=this;self.setOptions(options);self.movie=movie;self.create();if(self.el)
self.el.addClass(self.class_name)},create:function(){},disable:function(){if(this.el)
this.el.addClass('disable')},enable:function(){if(this.el)
this.el.removeClass('disable')},getTitle:function(){var self=this;try{return self.movie.getTitle();}
catch(e){try{return self.movie.original_title?self.movie.original_title:self.movie.titles[0];}
catch(e){return'Unknown';}}},get:function(key){var self=this;try{return self.movie.get(key)}
catch(e){return self.movie[key]}},createMask:function(){var self=this;self.mask=new Element('div.mask',{'styles':{'z-index':'1'}}).inject(self.movie,'top').fade('hide');},toElement:function(){return this.el||null}});var MA={};MA.IMDB=new Class({Extends:MovieAction,id:null,create:function(){var self=this;self.id=self.movie.getIdentifier?self.movie.getIdentifier():self.get('imdb');self.el=new Element('a.imdb',{'title':'Go to the IMDB page of '+self.getTitle(),'href':'http://www.imdb.com/title/'+self.id+'/','target':'_blank'});if(!self.id)self.disable();}});MA.Release=new Class({Extends:MovieAction,create:function(){var self=this;self.el=new Element('a.releases.download',{'title':'Show the releases that are available for '+self.getTitle(),'events':{'click':self.show.bind(self)}});if(!self.movie.data.releases||self.movie.data.releases.length==0)
self.el.hide();else
self.showHelper();App.on('movie.searcher.ended',function(notification){if(self.movie.data._id!=notification.data._id)return;self.releases=null;if(self.options_container){if(self.options_container.isDisplayed()){self.options_container.destroy();self.createReleases();}
else{self.options_container.destroy();self.options_container=null;}}});},show:function(e){var self=this;if(e)
(e).preventDefault();self.createReleases();},createReleases:function(refresh){var self=this;if(!self.options_container||refresh){self.options_container=new Element('div.options').grab(self.release_container=new Element('div.releases.table'));new Element('div.item.head').adopt(new Element('span.name',{'text':'Release name'}),new Element('span.status',{'text':'Status'}),new Element('span.quality',{'text':'Quality'}),new Element('span.size',{'text':'Size'}),new Element('span.age',{'text':'Age'}),new Element('span.score',{'text':'Score'}),new Element('span.provider',{'text':'Provider'})).inject(self.release_container);if(self.movie.data.releases)
self.movie.data.releases.each(function(release){var quality=Quality.getQuality(release.quality)||{},info=release.info||{},provider=self.get(release,'provider')+(info['provider_extra']?self.get(release,'provider_extra'):'');var release_name=self.get(release,'name');if(release.files&&release.files.length>0){try{var movie_file=release.files.filter(function(file){var type=File.Type.get(file.type_id);return type&&type.identifier=='movie'}).pick();release_name=movie_file.path.split(Api.getOption('path_sep')).getLast();}
catch(e){}}
release['el']=new Element('div',{'class':'item '+release.status,'id':'release_'+release._id}).adopt(new Element('span.name',{'text':release_name,'title':release_name}),new Element('span.status',{'text':release.status,'class':'release_status '+release.status}),new Element('span.quality',{'text':quality.label+(release.is_3d?' 3D':'')||'n/a'}),new Element('span.size',{'text':info['size']?Math.floor(self.get(release,'size')):'n/a'}),new Element('span.age',{'text':self.get(release,'age')}),new Element('span.score',{'text':self.get(release,'score')}),new Element('span.provider',{'text':provider,'title':provider}),info['detail_url']?new Element('a.info.icon2',{'href':info['detail_url'],'target':'_blank'}):new Element('a'),new Element('a.download.icon2',{'events':{'click':function(e){(e).preventDefault();if(!this.hasClass('completed'))
self.download(release);}}}),new Element('a.delete.icon2',{'events':{'click':function(e){(e).preventDefault();self.ignore(release);}}})).inject(self.release_container);if(release.status=='ignored'||release.status=='failed'||release.status=='snatched'){if(!self.last_release||(self.last_release&&self.last_release.status!='snatched'&&release.status=='snatched'))
self.last_release=release;}
else if(!self.next_release&&release.status=='available'){self.next_release=release;}
var update_handle=function(notification){if(notification.data._id!=release._id)return;var q=self.movie.quality.getElement('.q_'+release.quality),new_status=notification.data.status;release.el.set('class','item '+new_status);var status_el=release.el.getElement('.release_status');status_el.set('class','release_status '+new_status);status_el.set('text',new_status);if(!q&&(new_status=='snatched'||new_status=='seeding'||new_status=='done'))
q=self.addQuality(release.quality_id);if(q&&!q.hasClass(new_status)){q.removeClass(release.status).addClass(new_status);q.set('title',q.get('title').replace(release.status,new_status));}};App.on('release.update_status',update_handle);});if(self.last_release)
self.release_container.getElements('#release_'+self.last_release._id).addClass('last_release');if(self.next_release)
self.release_container.getElements('#release_'+self.next_release._id).addClass('next_release');if(self.next_release||(self.last_release&&['ignored','failed'].indexOf(self.last_release.status)===false)){self.trynext_container=new Element('div.buttons.try_container').inject(self.release_container,'top');var nr=self.next_release,lr=self.last_release;self.trynext_container.adopt(new Element('span.or',{'text':'If anything went wrong, download'}),lr?new Element('a.button.orange',{'text':'the same release again','events':{'click':function(){self.download(lr);}}}):null,nr&&lr?new Element('span.or',{'text':','}):null,nr?[new Element('a.button.green',{'text':lr?'another release':'the best release','events':{'click':function(){self.download(nr);}}}),new Element('span.or',{'text':'or pick one below'})]:null)}
self.last_release=null;self.next_release=null;}
self.options_container.inject(self.movie,'top');self.movie.slide('in',self.options_container);},showHelper:function(e){var self=this;if(e)
(e).preventDefault();var has_available=false,has_snatched=false;if(self.movie.data.releases)
self.movie.data.releases.each(function(release){if(has_available&&has_snatched)return;if(['snatched','downloaded','seeding','done'].contains(release.status))
has_snatched=true;if(['available'].contains(release.status))
has_available=true;});if(has_available||has_snatched){self.trynext_container=new Element('div.buttons.trynext').inject(self.movie.info_container);self.trynext_container.adopt(has_available?[new Element('a.icon2.readd',{'text':has_snatched?'Download another release':'Download the best release','events':{'click':self.tryNextRelease.bind(self)}}),new Element('a.icon2.download',{'text':'pick one yourself','events':{'click':function(){self.movie.quality.fireEvent('click');}}})]:null,new Element('a.icon2.completed',{'text':'mark this movie done','events':{'click':self.markMovieDone.bind(self)}}))}},get:function(release,type){return(release.info&&release.info[type]!==undefined)?release.info[type]:'n/a'},download:function(release){var self=this;var release_el=self.release_container.getElement('#release_'+release._id),icon=release_el.getElement('.download.icon2');if(icon)
icon.addClass('icon spinner').removeClass('download');Api.request('release.manual_download',{'data':{'id':release._id},'onComplete':function(json){if(icon)
icon.removeClass('icon spinner');if(json.success){if(icon)
icon.addClass('completed');release_el.getElement('.release_status').set('text','snatched');}
else
if(icon)
icon.addClass('attention').set('title','Something went wrong when downloading, please check logs.');}});},ignore:function(release){Api.request('release.ignore',{'data':{'id':release._id}})},markMovieDone:function(){var self=this;Api.request('media.delete',{'data':{'id':self.movie.get('_id'),'delete_from':'wanted'},'onComplete':function(){var movie=$(self.movie);movie.set('tween',{'duration':300,'onComplete':function(){self.movie.destroy()}});movie.tween('height',0);}});},tryNextRelease:function(){var self=this;Api.request('movie.searcher.try_next',{'data':{'media_id':self.movie.get('_id')}});}});MA.Trailer=new Class({Extends:MovieAction,id:null,create:function(){var self=this;self.el=new Element('a.trailer',{'title':'Watch the trailer of '+self.getTitle(),'events':{'click':self.watch.bind(self)}});},watch:function(offset){var self=this;var data_url='https://www.googleapis.com/youtube/v3/search?q="{title}" {year} trailer&maxResults=1&type=video&videoDefinition=high&videoEmbeddable=true&part=snippet&key=AIzaSyAT3li1KjfLidaL6Vt8T92MRU7n4VOrjYk'
var url=data_url.substitute({'title':encodeURI(self.getTitle()),'year':self.get('year'),'offset':offset||1}),size=$(self.movie).getSize(),height=self.options.height||(size.x/16)*9,id='trailer-'+randomString();self.player_container=new Element('div[id='+id+']');self.container=new Element('div.hide.trailer_container').adopt(self.player_container).inject($(self.movie),'top');self.container.setStyle('height',0);self.container.removeClass('hide');self.close_button=new Element('a.hide.hide_trailer',{'text':'Hide trailer','events':{'click':self.stop.bind(self)}}).inject(self.movie);self.container.setStyle('height',height);$(self.movie).setStyle('height',height);new Request.JSONP({'url':url,'onComplete':function(json){self.player=new YT.Player(id,{'height':height,'width':size.x,'videoId':json.items[0].id.videoId,'playerVars':{'autoplay':1,'showsearch':0,'wmode':'transparent','iv_load_policy':3}});self.close_button.removeClass('hide');var quality_set=false;var change_quality=function(state){if(!quality_set&&(state.data==1||state.data||2)){try{self.player.setPlaybackQuality('hd720');quality_set=true;}
catch(e){}}};self.player.addEventListener('onStateChange',change_quality);}}).send()},stop:function(){var self=this;self.player.stopVideo();self.container.addClass('hide');self.close_button.addClass('hide');$(self.movie).setStyle('height',null);setTimeout(function(){self.container.destroy();self.close_button.destroy();},1800)}});MA.Edit=new Class({Extends:MovieAction,create:function(){var self=this;self.el=new Element('a.edit',{'title':'Change movie information, like title and quality.','events':{'click':self.editMovie.bind(self)}});},editMovie:function(e){var self=this;(e).preventDefault();if(!self.options_container){self.options_container=new Element('div.options').adopt(new Element('div.form').adopt(self.title_select=new Element('select',{'name':'title'}),self.profile_select=new Element('select',{'name':'profile'}),self.category_select=new Element('select',{'name':'category'}).grab(new Element('option',{'value':-1,'text':'None'})),new Element('a.button.edit',{'text':'Save & Search','events':{'click':self.save.bind(self)}}))).inject(self.movie,'top');Array.each(self.movie.data.info.titles,function(title){new Element('option',{'text':title}).inject(self.title_select);if(title==self.movie.data.title)
self.title_select.set('value',title);});var categories=CategoryList.getAll();if(categories.length==0)
self.category_select.hide();else{self.category_select.show();categories.each(function(category){var category_id=category.data._id;new Element('option',{'value':category_id,'text':category.data.label}).inject(self.category_select);if(self.movie.category&&self.movie.category.data&&self.movie.category.data._id==category_id)
self.category_select.set('value',category_id);});}
var profiles=Quality.getActiveProfiles();if(profiles.length==1)
self.profile_select.hide();profiles.each(function(profile){var profile_id=profile.get('_id');new Element('option',{'value':profile_id,'text':profile.label?profile.label:profile.data.label}).inject(self.profile_select);if(self.movie.get('profile_id')==profile_id)
self.profile_select.set('value',profile_id);});}
self.movie.slide('in',self.options_container);},save:function(e){(e).preventDefault();var self=this;Api.request('movie.edit',{'data':{'id':self.movie.get('_id'),'default_title':self.title_select.get('value'),'profile_id':self.profile_select.get('value'),'category_id':self.category_select.get('value')},'useSpinner':true,'spinnerTarget':$(self.movie),'onComplete':function(){self.movie.quality.set('text',self.profile_select.getSelected()[0].get('text'));self.movie.title.set('text',self.title_select.getSelected()[0].get('text'));}});self.movie.slide('out');}});MA.Refresh=new Class({Extends:MovieAction,create:function(){var self=this;self.el=new Element('a.refresh',{'title':'Refresh the movie info and do a forced search','events':{'click':self.doRefresh.bind(self)}});},doRefresh:function(e){var self=this;(e).preventDefault();Api.request('media.refresh',{'data':{'id':self.movie.get('_id')}});}});MA.Readd=new Class({Extends:MovieAction,create:function(){var self=this;var movie_done=self.movie.data.status=='done';if(self.movie.data.releases&&!movie_done)
var snatched=self.movie.data.releases.filter(function(release){return release.status&&(release.status=='snatched'||release.status=='seeding'||release.status=='downloaded'||release.status=='done');}).length;if(movie_done||snatched&&snatched>0)
self.el=new Element('a.readd',{'title':'Re-add the movie and mark all previous snatched/downloaded as ignored','events':{'click':self.doReadd.bind(self)}});},doReadd:function(e){var self=this;(e).preventDefault();Api.request('movie.add',{'data':{'identifier':self.movie.getIdentifier(),'ignore_previous':1}});}});MA.Delete=new Class({Extends:MovieAction,Implements:[Chain],create:function(){var self=this;self.el=new Element('a.delete',{'title':'Remove the movie from this CP list','events':{'click':self.showConfirm.bind(self)}});},showConfirm:function(e){var self=this;(e).preventDefault();if(!self.delete_container){self.delete_container=new Element('div.buttons.delete_container').adopt(new Element('a.cancel',{'text':'Cancel','events':{'click':self.hideConfirm.bind(self)}}),new Element('span.or',{'text':'or'}),new Element('a.button.delete',{'text':'Delete '+self.movie.title.get('text'),'events':{'click':self.del.bind(self)}})).inject(self.movie,'top');}
self.movie.slide('in',self.delete_container);},hideConfirm:function(e){var self=this;(e).preventDefault();self.movie.removeView();self.movie.slide('out');},del:function(e){(e).preventDefault();var self=this;var movie=$(self.movie);self.chain(function(){self.callChain();},function(){Api.request('media.delete',{'data':{'id':self.movie.get('_id'),'delete_from':self.movie.list.options.identifier},'onComplete':function(){movie.set('tween',{'duration':300,'onComplete':function(){self.movie.destroy()}});movie.tween('height',0);}});});self.callChain();}});MA.Files=new Class({Extends:MovieAction,create:function(){var self=this;if(self.movie.data.releases&&self.movie.data.releases.length>0)
self.el=new Element('a.directory',{'title':'Available files','events':{'click':self.show.bind(self)}});},show:function(){var self=this;if(!self.options_container){self.options_container=new Element('div.options').adopt(self.files_container=new Element('div.files.table')).inject(self.movie,'top');new Element('div.item.head').adopt(new Element('span.name',{'text':'File'}),new Element('span.type',{'text':'Type'})).inject(self.files_container);if(self.movie.data.releases)
Array.each(self.movie.data.releases,function(release){var rel=new Element('div.release').inject(self.files_container);Object.each(release.files,function(files,type){Array.each(files,function(file){new Element('div.file.item').adopt(new Element('span.name',{'text':file}),new Element('span.type',{'text':type})).inject(rel)});});});}
self.movie.slide('in',self.options_container);}});

// /opt/couchpotato/couchpotato/core/media/movie/charts/static/charts.js:1432482254
var Charts=new Class({Implements:[Options,Events],shown_once:false,initialize:function(options){var self=this;self.setOptions(options);self.create();},create:function(){var self=this;self.el=new Element('div.charts').adopt(self.el_no_charts_enabled=new Element('p.no_charts_enabled',{'html':'Hey, it looks like you have no charts enabled at the moment. If you\'d like some great movie suggestions you can go to <a href="'+App.createUrl('settings/display')+'">settings</a> and turn on some charts of your choice.'}),self.el_refresh_container=new Element('div.refresh').adopt(self.el_refresh_link=new Element('a.refresh.icon2',{'href':'#','events':{'click':function(e){e.preventDefault();self.el.getElements('.chart').destroy();self.el_refreshing_text.show();self.el_refresh_link.hide();self.api_request=Api.request('charts.view',{'data':{'force_update':1},'onComplete':self.fill.bind(self)});}}}),self.el_refreshing_text=new Element('span.refreshing',{'text':'Refreshing charts...'})));if(Cookie.read('suggestions_charts_menu_selected')==='charts'){self.show();}
else
self.el.hide();self.fireEvent.delay(0,self,'created');},fill:function(json){var self=this;self.el_refreshing_text.hide();self.el_refresh_link.show();if(!json||json.count==0){self.el_no_charts_enabled.show();self.el_refresh_link.show();self.el_refreshing_text.hide();}
else{self.el_no_charts_enabled.hide();json.charts.sort(function(a,b){return a.order-b.order;});Object.each(json.charts,function(chart){var c=new Element('div.chart.tiny_scroll').grab(new Element('h3').grab(new Element('a',{'text':chart.name,'href':chart.url})));var it=1;Object.each(chart.list,function(movie){var m=new Block.Search.MovieItem(movie,{'onAdded':function(){self.afterAdded(m,movie)}});var in_database_class=(chart.hide_wanted&&movie.in_wanted)?'hidden':(movie.in_wanted?'chart_in_wanted':((chart.hide_library&&movie.in_library)?'hidden':(movie.in_library?'chart_in_library':''))),in_database_title=movie.in_wanted?'Movie in wanted list':(movie.in_library?'Movie in library':'');m.el.addClass(in_database_class).grab(new Element('div.chart_number',{'text':it++,'title':in_database_title}));m.data_container.grab(new Element('div.actions').adopt(new Element('a.add.icon2',{'title':'Add movie with your default quality','data-add':movie.imdb,'events':{'click':m.showOptions.bind(m)}}),$(new MA.IMDB(m)),$(new MA.Trailer(m,{'height':150}))));m.data_container.removeEvents('click');var plot=false;if(m.info.plot&&m.info.plot.length>0)
plot=m.info.plot;m.info_container.adopt(m.rating=m.info.rating&&m.info.rating.imdb&&m.info.rating.imdb.length==2&&parseFloat(m.info.rating.imdb[0])>0?new Element('span.rating',{'text':parseFloat(m.info.rating.imdb[0]),'title':parseInt(m.info.rating.imdb[1])+' votes'}):null,m.genre=m.info.genres&&m.info.genres.length>0?new Element('span.genres',{'text':m.info.genres.slice(0,3).join(', ')}):null,m.plot=plot?new Element('span.plot',{'text':plot,'events':{'click':function(){this.toggleClass('full')}}}):null);$(m).inject(c);});c.inject(self.el);});}
self.fireEvent('loaded');},show:function(){var self=this;self.el.show();if(!self.shown_once){self.api_request=Api.request('charts.view',{'onComplete':self.fill.bind(self)});self.shown_once=true;}},hide:function(){this.el.hide();},afterAdded:function(m){$(m).getElement('div.chart_number').addClass('chart_in_wanted').set('title','Movie in wanted list');},toElement:function(){return this.el;}});

// /opt/couchpotato/couchpotato/core/media/movie/providers/automation/trakt/static/trakt.js:1432482254
var TraktAutomation=new Class({initialize:function(){var self=this;App.addEvent('loadSettings',self.addRegisterButton.bind(self));},addRegisterButton:function(){var self=this,setting_page=App.getPage('Settings');setting_page.addEvent('create',function(){var fieldset=setting_page.tabs.automation.groups.trakt_automation,l=window.location;var trakt_set=0;fieldset.getElements('input[type=text]').each(function(el){trakt_set+=+(el.get('value')!='');});new Element('.ctrlHolder').adopt((trakt_set>0)?[self.unregister=new Element('a.button.red',{'text':'Unregister','events':{'click':function(){fieldset.getElements('input[name*=oauth_token]').set('value','').fireEvent('change');self.unregister.destroy();self.unregister_or.destroy();}}}),self.unregister_or=new Element('span[text=or]')]:null,new Element('a.button',{'text':trakt_set>0?'Register a different account':'Register your trakt.tv account','events':{'click':function(){Api.request('automation.trakt.auth_url',{'data':{'host':l.protocol+'//'+l.hostname+(l.port?':'+l.port:'')},'onComplete':function(json){window.location=json.url;}});}}})).inject(fieldset);})}});new TraktAutomation();

// /opt/couchpotato/couchpotato/core/media/movie/suggestion/static/suggest.js:1432482254
var SuggestList=new Class({Implements:[Options,Events],shown_once:false,initialize:function(options){var self=this;self.setOptions(options);self.create();},create:function(){var self=this;self.el=new Element('div.suggestions',{'events':{'click:relay(a.delete)':function(e,el){(e).stop();$(el).getParent('.media_result').destroy();Api.request('suggestion.ignore',{'data':{'imdb':el.get('data-ignore')},'onComplete':self.fill.bind(self)});},'click:relay(a.eye-open)':function(e,el){(e).stop();$(el).getParent('.media_result').destroy();Api.request('suggestion.ignore',{'data':{'imdb':el.get('data-seen'),'mark_seen':1},'onComplete':self.fill.bind(self)});}}});var cookie_menu_select=Cookie.read('suggestions_charts_menu_selected')||'suggestions';if(cookie_menu_select==='suggestions')
self.show();else
self.hide();self.fireEvent.delay(0,self,'created');},fill:function(json){var self=this;if(!json||json.count==0){self.el.hide();}
else{Object.each(json.suggestions,function(movie){var m=new Block.Search.MovieItem(movie,{'onAdded':function(){self.afterAdded(m,movie)}});m.data_container.grab(new Element('div.actions').adopt(new Element('a.add.icon2',{'title':'Add movie with your default quality','data-add':movie.imdb,'events':{'click':m.showOptions.bind(m)}}),$(new MA.IMDB(m)),$(new MA.Trailer(m,{'height':150})),new Element('a.delete.icon2',{'title':'Don\'t suggest this movie again','data-ignore':movie.imdb}),new Element('a.eye-open.icon2',{'title':'Seen it, like it, don\'t add','data-seen':movie.imdb})));m.data_container.removeEvents('click');var plot=false;if(m.info.plot&&m.info.plot.length>0)
plot=m.info.plot;m.info_container.adopt(m.rating=m.info.rating&&m.info.rating.imdb&&m.info.rating.imdb.length==2&&parseFloat(m.info.rating.imdb[0])>0?new Element('span.rating',{'text':parseFloat(m.info.rating.imdb[0]),'title':parseInt(m.info.rating.imdb[1])+' votes'}):null,m.genre=m.info.genres&&m.info.genres.length>0?new Element('span.genres',{'text':m.info.genres.slice(0,3).join(', ')}):null,m.plot=plot?new Element('span.plot',{'text':plot,'events':{'click':function(){this.toggleClass('full')}}}):null);$(m).inject(self.el);});}
self.fireEvent('loaded');},afterAdded:function(m,movie){var self=this;setTimeout(function(){$(m).destroy();Api.request('suggestion.ignore',{'data':{'imdb':movie.imdb,'remove_only':true},'onComplete':self.fill.bind(self)});},3000);},show:function(){var self=this;self.el.show();if(!self.shown_once){self.api_request=Api.request('suggestion.view',{'onComplete':self.fill.bind(self)});self.shown_once=true;}},hide:function(){this.el.hide();},toElement:function(){return this.el;}});